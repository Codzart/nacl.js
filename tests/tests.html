<!doctype html>
<html>
	<head>
		<!-- helpers -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<link rel="stylesheet" href="qunit/qunit.css" media="screen" />
		<script src="qunit/qunit.js"></script>
		<script type="text/javascript" src="http://crypto-js.googlecode.com/files/2.5.3-crypto-md5.js"></script>
		
		<!-- files to test -->
		<script src="../js/nacl.js"></script>
		<script src="../js/crypto/curve25519.js"></script>
		
		<!-- tests -->
		<script>
			$(function() {
				// curve25519.js
				module("crypto/curve25519.js");
					// add
					test("add", function() {
						// test 1
						var outv = [174,45,35,124,72,240,23,132,207,226,221,84,155,251,195,215,64,21,214,150,55,212,87,140,146,4,198,201,100,167,204,171,126,136,174,65,42,192,128,245,41,150,84,153,197,220,247,99,250,4,106,194,56,24,33,78,125,102,244,69,9,170,41,226];
						var outvoffset = 0;
						var a = [233,202,196,203,152,17,192,30,170,110,36,49,13,94,53,81,91,57,125,74,76,101,67,144,123,251,83,29,11,162,241,14,229,89,157,176,58,72,191,144,3,159,50,99,173,194,242,224,70,72,152,107,63,119,119,177,113,244,118,76,119,8,237,78];
						var aoffset = 0;
						var b = [233,202,196,203,152,17,192,30,170,110,36,49,13,94,53,81,91,57,125,74,76,101,67,144,123,251,83,29,11,162,241,14,229,89,157,176,58,72,191,144,3,159,50,99,173,194,242,224,70,72,152,107,63,119,119,177,113,244,118,76,119,8,237,78];
						var boffset = 32;
						
						curve25519.add(outv, outvoffset, a, aoffset, b, boffset);
						var expected = [206,36,98,124,211,89,127,175,173,13,87,148,186,32,40,50,162,129,21,182,139,220,186,65,237,239,202,105,130,170,222,93,126,136,174,65,42,192,128,245,41,150,84,153,197,220,247,99,250,4,106,194,56,24,33,78,125,102,244,69,9,170,41,226];
						
						deepEqual(outv, expected, "test 1");
					});
					
					// sub
					test("sub", function() {
						// test 1
						var outv = [106,221,54,237,179,24,186,251,52,249,109,251,181,29,132,179,225,164,93,107,56,81,100,225,113,62,239,156,246,237,96,222];
						var outvoffset = 0;
						var a = [60,13,151,166,34,85,166,60,14,43,153,127,137,24,188,239,163,28,76,169,113,78,4,195,194,197,8,250,6,108,13,100,150,185,96,168,136,126,251,95,98,71,117,114,98,192,197,74,18,176,235,235,179,166,253,107,122,146,120,216,139,208,217,124];
						var aoffset = 0;
						var b = [60,13,151,166,34,85,166,60,14,43,153,127,137,24,188,239,163,28,76,169,113,78,4,195,194,197,8,250,6,108,13,100,150,185,96,168,136,126,251,95,98,71,117,114,98,192,197,74,18,176,235,235,179,166,253,107,122,146,120,216,139,208,217,124];
						var boffset = 32;
						
						curve25519.sub(outv, outvoffset, a, aoffset, b, boffset);
						var expected = [128,83,54,254,153,214,170,220,171,227,35,13,39,88,246,164,145,108,96,189,189,167,6,87,72,51,144,33,123,155,51,231];
						
						deepEqual(outv, expected, "test 1");
					});
					
					// squeeze
					test("squeeze", function() {
						// test 1
						var a = [19429880,18618998,15577482,15055484,16690285,16318063,13513395,13369706,11347166,12541030,12755418,11068746,9951319,10917682,10537482,8358336,9069984,8800142,8727901,6934221,6320307,5718616,5890373,4726509,4770545,3473003,2324011,1585954,1103762,780621,480999,522542,165,126,98,153,156,253,213,164,221,131,67,190,234,227,183,170,143,159,87,181,146,248,22,153,49,108,226,9,74,225,49,35];
						var aoffset = 0;
						
						curve25519.squeeze(a, aoffset);
						var expected = [11,32,206,74,22,2,177,150,174,87,228,171,255,179,57,49,203,115,47,129,7,51,232,37,106,126,114,205,232,60,225,16,165,126,98,153,156,253,213,164,221,131,67,190,234,227,183,170,143,159,87,181,146,248,22,153,49,108,226,9,74,225,49,35];
						
						deepEqual(a, expected, "test 1");
					});
					
					// freeze
					test("freeze", function() {
						// test 1
						var a = [205,173,218,204,43,141,253,162,52,142,96,72,88,70,137,38,24,22,187,136,55,45,103,214,147,73,94,161,208,179,32,113,1,92,11,85,188,70,80,149,214,251,164,88,28,178,53,72,70,69,62,222,82,150,196,59,128,247,18,250,150,167,228,19,125,163,242,45,226,116,19,222,164,172,9,99,85,213,38,245,3,162,150,60,94,15,115,197,41,29,146,192,230,139,123,24];
						var aoffset = 64;
						
						curve25519.freeze(a, aoffset);
						var expected = [224,173,218,204,43,141,253,162,52,142,96,72,88,70,137,38,24,22,187,136,55,45,103,214,147,73,94,161,208,179,32,241,1,92,11,85,188,70,80,149,214,251,164,88,28,178,53,72,70,69,62,222,82,150,196,59,128,247,18,250,150,167,228,19,125,163,242,45,226,116,19,222,164,172,9,99,85,213,38,245,3,162,150,60,94,15,115,197,41,29,146,192,230,139,123,24];
						
						deepEqual(a, expected, "test 1");
					});
					
					// mult
					test("mult", function() {
						// test 1
						var outv = [234,214,191,108,18,154,66,75,137,9,163,153,81,139,183,209,123,222,224,76,97,105,138,222,60,128,79,159,178,58,175,34,224,144,75,57,242,84,241,178,96,84,190,130,116,121,179,70,237,76,73,225,24,72,64,216,187,160,153,101,220,103,57,76];
						var outvoffset = 0;
						var a = [140,160,14,191,150,56,171,137,254,207,28,53,44,243,147,185,7,150,93,204,143,173,161,218,41,124,63,6,74,202,39,117,16,119,169,122,209,197,165,179,119,25,194,0,183,94,38,233,49,19,115,20,129,33,121,15,126,184,236,131,67,25,192,331];
						var aoffset = 0;
						var b = [239,133,113,228,166,43,180,21,189,217,25,114,84,243,163,94,108,65,244,182,129,218,143,183,44,25,250,71,239,42,204,147,241,95,226,75,142,147,252,39,53,252,37,203,121,179,144,146,228,106,177,244,37,170,45,236,161,121,50,99,242,35,126,232];
						var boffset = 32;
						
						curve25519.mult(outv, outvoffset, a, aoffset, b, boffset);
						var expected = [136,211,146,2,27,130,238,221,63,182,11,14,162,99,133,161,233,21,220,219,57,7,90,78,232,91,180,224,151,228,87,48,224,144,75,57,242,84,241,178,96,84,190,130,116,121,179,70,237,76,73,225,24,72,64,216,187,160,153,101,220,103,57,76];
						
						deepEqual(outv, expected, "test 1");
					});
					
					// mult121665
					test("mult121665", function() {
						// test 1
						var outv = [134,104,123,129,29,210,233,232,3,110,202,190,224,240,46,202,143,99,86,23,92,80,205,212,34,66,204,114,215,6,158,22];
						var a = [139,27,150,4,116,82,168,226,200,106,243,133,83,146,213,13,202,173,165,131,59,193,55,122,40,174,94,132,8,39,207,183];
						
						curve25519.mult121665(outv, a);
						var expected = [51,142,106,175,247,51,186,221,143,217,240,169,191,32,187,201,248,7,135,214,96,125,177,123,12,83,47,73,197,182,5,9];
						
						deepEqual(outv, expected, "test 1");
					});
					
					// square
					test("square", function() {
						// test 1
						var outv = [126,53,66,118,128,0,211,162,243,71,56,78,12,80,42,108,43,200,254,2,111,36,250,120,35,64,53,159,172,162,109,71];
						var outvoffset = 0;
						var a = [206,180,239,205,126,88,97,69,58,120,39,2,195,133,156,179,11,74,241,48,169,32,242,42,54,250,92,194,107,119,48,132,206,212,25,207,33,201,92,167,203,206,219,222,162,160,47,239,242,89,21,200,233,27,242,244,234,49,225,129,41,124,210,262];
						var aoffset = 32;
						
						curve25519.square(outv, outvoffset, a, aoffset);
						var expected = [57,175,192,21,183,32,228,1,145,202,191,185,176,251,235,105,69,96,66,203,7,227,162,238,87,81,25,20,130,134,133,18];
						
						deepEqual(outv, expected, "test 1");
					});
					
					// select
					test("select", function() {
						// test 1
						var p = [43,174,33,67,15,215,167,120,76,52,42,238,75,152,198,13,18,26,78,25,182,116,29,38,129,56,198,94,75,218,25,52,252,30,237,109,78,214,40,43,151,89,1,78,241,135,231,39,26,24,36,109,9,136,0,155,83,134,163,10,64,68,224,111];
						var q = [241,175,111,135,44,5,244,191,253,56,66,2,205,30,106,94,198,43,6,103,92,55,174,103,151,147,93,246,57,58,144,100,149,0,248,45,140,127,31,80,93,53,139,2,109,153,20,156,228,212,251,251,73,183,4,237,12,217,150,163,232,31,141,4];
						var r = [219,211,98,171,158,176,40,63,191,235,236,201,24,244,84,27,184,182,129,24,81,150,156,178,124,170,157,85,163,124,188,98,179,70,245,231,30,90,47,139,63,68,231,114,173,78,75,145,57,229,90,61,46,121,216,200,13,243,176,232,54,157,10,125];
						var s = [131,171,66,51,218,97,157,105,212,158,209,241,136,6,201,181,177,96,165,122,29,221,24,56,145,230,9,239,174,134,87,126,228,129,236,129,235,143,239,152,84,88,235,140,66,103,60,120,169,239,239,186,169,230,28,120,89,129,14,16,97,213,228,19];
						var b = 1;
						
						curve25519.select(p, q, r, s, b);
						var expectedP = [131,171,66,51,218,97,157,105,212,158,209,241,136,6,201,181,177,96,165,122,29,221,24,56,145,230,9,239,174,134,87,126,228,129,236,129,235,143,239,152,84,88,235,140,66,103,60,120,169,239,239,186,169,230,28,120,89,129,14,16,97,213,228,19];
						var expectedQ = [219,211,98,171,158,176,40,63,191,235,236,201,24,244,84,27,184,182,129,24,81,150,156,178,124,170,157,85,163,124,188,98,179,70,245,231,30,90,47,139,63,68,231,114,173,78,75,145,57,229,90,61,46,121,216,200,13,243,176,232,54,157,10,125];
						
						deepEqual(p, expectedP, "test 1 q");
						deepEqual(q, expectedQ, "test 1 p");
					});
					
					// mainloop
					test("mainloop", function() {
						// test 1
						var work = [12,186,102,6,104,150,255,181,30,146,188,60,54,255,166,39,194,73,55,112,217,176,180,54,138,36,102,200,1,176,24,78,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
						var e = [16,105,112,101,56,72,-66,82,66,5,-98,35,8,-33,-93,2,69,-71,58,19,-66,-3,46,-67,9,-16,-101,-105,18,115,-73,104];
						
						curve25519.mainloop(work, e);
						var expected = [205,173,218,204,43,141,253,162,52,142,96,72,88,70,137,38,24,22,187,136,55,45,103,214,147,73,94,161,208,179,32,113,122,168,110,131,18,26,46,51,81,178,214,156,235,120,172,196,81,91,36,80,173,51,108,53,234,2,19,64,244,89,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
						
						deepEqual(work, expected, "test 1");
					});
					
					// recip
					test("recip", function() {
						// test 1
						var outv = [205,173,218,204,43,141,253,162,52,142,96,72,88,70,137,38,24,22,187,136,55,45,103,214,147,73,94,161,208,179,32,113,122,168,110,131,18,26,46,51,81,178,214,156,235,120,172,196,81,91,36,80,173,51,108,53,234,2,19,64,244,89,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
						var outvoffset = 32;
						var z = outv;
						var zoffset = 32;
						
						curve25519.recip(outv, outvoffset, z, zoffset);
						var expectedOutv = [205,173,218,204,43,141,253,162,52,142,96,72,88,70,137,38,24,22,187,136,55,45,103,214,147,73,94,161,208,179,32,113,1,92,11,85,188,70,80,149,214,251,164,88,28,178,53,72,70,69,62,222,82,150,196,59,128,247,18,250,150,167,228,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
						var expectedZ =    [205,173,218,204,43,141,253,162,52,142,96,72,88,70,137,38,24,22,187,136,55,45,103,214,147,73,94,161,208,179,32,113,1,92,11,85,188,70,80,149,214,251,164,88,28,178,53,72,70,69,62,222,82,150,196,59,128,247,18,250,150,167,228,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
						
						deepEqual(outv, expectedOutv, "test 1 outv");
						deepEqual(z, expectedZ, "test 1 z");
					});
					
					// crypto_scalarmult
					test("crypto_scalarmult", function() {
						// test 1
						var q = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
						var n = [23,105,112,101,56,72,-66,82,66,5,-98,35,8,-33,-93,2,69,-71,58,19,-66,-3,46,-67,9,-16,-101,-105,18,115,-73,40];
						var p = [12,-70,102,6,104,-106,-1,-75,30,-110,-68,60,54,-1,-90,39,-62,73,55,112,-39,-80,-76,54,-118,36,102,-56,1,-80,24,78];
						
						var retValue = curve25519.crypto_scalarmult(q, n, p);
						var expectedQ = [125,-93,-14,45,-30,116,19,-34,-92,-84,9,99,85,-43,38,-11,3,-94,-106,60,94,15,115,-59,41,29,-110,-64,-26,-117,123,24];
						var expectedN = [23,105,112,101,56,72,-66,82,66,5,-98,35,8,-33,-93,2,69,-71,58,19,-66,-3,46,-67,9,-16,-101,-105,18,115,-73,40];
						var expectedP = [12,-70,102,6,104,-106,-1,-75,30,-110,-68,60,54,-1,-90,39,-62,73,55,112,-39,-80,-76,54,-118,36,102,-56,1,-80,24,78];
						
						deepEqual(q, expectedQ, "test 1 q");
						deepEqual(n, expectedN, "test 1 n");
						deepEqual(p, expectedP, "test 1 p");
						deepEqual(retValue, 0, "test 1 return val");
					});
			});
		</script>
	</head>
	
	<body>
		<h1 id="qunit-header">nacl.js</h1>
		<h2 id="qunit-banner"></h2>
		<div id="qunit-testrunner-toolbar"></div>
		<h2 id="qunit-userAgent"></h2>
		<ol id="qunit-tests"></ol>
		<div id="qunit-fixture">test markup, will be hidden</div>
	</body>
</html>

<html>
<head>